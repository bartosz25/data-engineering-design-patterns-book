# Data representation - denormalizer - One Big Table

1. Generate the dataset:
```
cd dataset
mkdir -p /tmp/dedp/ch08/04-data-representation/02-denormalizer-one-big-table/input
docker-compose down --volumes; docker-compose up
```

2. Prepare the base tables by running `prepare_base_tables.py`
3. Explain the [one_big_table_tables_creator.py](one_big_table_tables_creator.py)
* the idea of One Big Table is to combine all related properties in the same row so that the reader doesn't 
  need to issue any `JOIN` operations
  * paradoxically, there is a `JOIN` involved to create the table! But it's a one-shot operation that will not
    be required for the readers
4. Run `one_big_table_tables_creator.py`
5. Run `one_big_table_tables_reader.py`. You should see all columns read without any joins:
```
+------------------+-----------+-----------+----------+-----------+----------+----------------+--------------------+----------------+--------------+-------------------------+----------+----------+------------+--------------+----+---------+----------------+------------+----------+------------------+--------------+
|visit_id          |dim_page_id|dim_date_id|event_time|page_id    |page_name |page_url        |dim_page_category_id|page_category_id|category_name |category_url             |date_id   |date      |dim_month_id|dim_quarter_id|year|month_id |month_short_name|month_number|quarter_id|quarter_short_name|quarter_number|
+------------------+-----------+-----------+----------+-----------+----------+----------------+--------------------+----------------+--------------+-------------------------+----------+----------+------------+--------------+----+---------+----------------+------------+----------+------------------+--------------+
|139723214510976_0 |-1038596635|2029133721 |16:05:00  |-1038596635|home      |pages/home      |-1457741490         |-1457741490     |cat_home      |categories/cat_home      |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_1 |-1428476315|2029133721 |16:02:00  |-1428476315|categories|pages/categories|-917330786          |-917330786      |cat_categories|categories/cat_categories|2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_2 |253160069  |2029133721 |16:04:00  |253160069  |contact   |pages/contact   |25168207            |25168207        |cat_contact   |categories/cat_contact   |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_3 |568280307  |2029133721 |16:05:00  |568280307  |index     |pages/index     |-307125960          |-307125960      |cat_index     |categories/cat_index     |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_4 |568280307  |2029133721 |16:03:00  |568280307  |index     |pages/index     |-307125960          |-307125960      |cat_index     |categories/cat_index     |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_5 |-1428476315|2029133721 |16:03:00  |-1428476315|categories|pages/categories|-917330786          |-917330786      |cat_categories|categories/cat_categories|2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_6 |-1038596635|2029133721 |16:01:00  |-1038596635|home      |pages/home      |-1457741490         |-1457741490     |cat_home      |categories/cat_home      |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_7 |1049381079 |2029133721 |16:04:00  |1049381079 |page_11   |pages/page_11   |-123536851          |-123536851      |cat_page_11   |categories/cat_page_11   |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_8 |568280307  |2029133721 |16:05:00  |568280307  |index     |pages/index     |-307125960          |-307125960      |cat_index     |categories/cat_index     |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_9 |1973918983 |2029133721 |16:05:00  |1973918983 |category_3|pages/category_3|1124165923          |1124165923      |cat_category_3|categories/cat_category_3|2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_10|-1638695205|2029133721 |16:05:00  |-1638695205|page_10   |pages/page_10   |1409101713          |1409101713      |cat_page_10   |categories/cat_page_10   |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_11|568280307  |2029133721 |16:03:00  |568280307  |index     |pages/index     |-307125960          |-307125960      |cat_index     |categories/cat_index     |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_12|-65788363  |2029133721 |16:05:00  |-65788363  |main      |pages/main      |1223299236          |1223299236      |cat_main      |categories/cat_main      |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_13|-1493389882|2029133721 |16:02:00  |-1493389882|page_17   |pages/page_17   |-328159982          |-328159982      |cat_page_17   |categories/cat_page_17   |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_14|253160069  |2029133721 |16:04:00  |253160069  |contact   |pages/contact   |25168207            |25168207        |cat_contact   |categories/cat_contact   |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_15|-1428476315|2029133721 |16:04:00  |-1428476315|categories|pages/categories|-917330786          |-917330786      |cat_categories|categories/cat_categories|2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_16|253160069  |2029133721 |16:03:00  |253160069  |contact   |pages/contact   |25168207            |25168207        |cat_contact   |categories/cat_contact   |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_17|253160069  |2029133721 |16:02:00  |253160069  |contact   |pages/contact   |25168207            |25168207        |cat_contact   |categories/cat_contact   |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_18|568280307  |2029133721 |16:03:00  |568280307  |index     |pages/index     |-307125960          |-307125960      |cat_index     |categories/cat_index     |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
|139723214510976_19|583922654  |2029133721 |16:02:00  |583922654  |page_19   |pages/page_19   |182722917           |182722917       |cat_page_19   |categories/cat_page_19   |2029133721|2023-11-23|944065163   |-397064898    |2023|944065163|Nov             |11          |-397064898|Quarter 4         |4             |
+------------------+-----------+-----------+----------+-----------+----------+----------------+--------------------+----------------+--------------+-------------------------+----------+----------+------------+--------------+----+---------+----------------+------------+----------+------------------+--------------+
only showing top 20 rows
```
